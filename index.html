<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Whisky Quiz - Amber Palette</title>
<style>
:root { --primary-color:#D2691E; --bg-color:#1a1a1a; --card-bg:#2d2d2d; --text-color:#f5f5f5; }
body { font-family:'Helvetica Neue',Arial,sans-serif; background:var(--bg-color); color:var(--text-color); margin:0; display:flex; justify-content:center; align-items:center; min-height:100vh; }
#quiz-app { width:90%; max-width:500px; background:var(--card-bg); padding:30px; border-radius:20px; box-shadow:0 20px 50px rgba(0,0,0,.6); position:relative; overflow:hidden; }

/* アニメーション */
.pop-num { animation: popScale 0.8s ease-out; }
@keyframes popScale { 0% { transform: scale(0.5); opacity: 0; } 20% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
.shake { animation: shake 0.3s ease-in-out; }
@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
.hidden { display:none; }

/* UIパーツ */
.level-menu { display:grid; gap:15px; text-align:center; }
.level-btn { background:#3d3d3d; border:2px solid var(--primary-color); color:white; padding:18px; border-radius:12px; cursor:pointer; font-size:1.1em; font-weight:bold; transition:0.2s; }
.level-btn:hover { background:var(--primary-color); }
.progress { color:var(--primary-color); font-size:.85em; margin-bottom:10px; letter-spacing:1px; }
.question { font-size:1.25em; font-weight:bold; margin-bottom:25px; min-height:80px; }
.options { display:grid; gap:12px; }
.option-btn { background:#3d3d3d; border:1px solid #555; color:white; padding:15px; border-radius:10px; cursor:pointer; transition:0.2s; }
.option-btn.correct { background-color:#4caf50 !important; border-color:#4caf50; }
.option-btn.wrong { background-color:#ef5350 !important; border-color:#ef5350; }
#feedback { margin-top:25px; padding:20px; background:rgba(255,255,255,.05); border-left:4px solid var(--primary-color); display:none; }
.next-btn { margin-top:25px; width:100%; padding:18px; background:var(--primary-color); border:none; color:white; border-radius:12px; font-weight:bold; cursor:pointer; display:none; }
.home-btn { background:transparent; border:1px solid #888; color:#aaa; padding:10px 18px; border-radius:8px; cursor:pointer; font-size:0.9em; transition:0.2s; }
#timer-container { width:100%; height:6px; background:#333; margin-bottom:20px; border-radius:3px; overflow:hidden; }
#timer-bar { width:100%; height:100%; background:var(--primary-color); transition: width 0.1s linear; }

/* 組み合わせ問題用 */
.matching-grid { display: flex; gap: 15px; margin-top: 10px; }
.matching-column { flex: 1; display: flex; flex-direction: column; gap: 10px; }
.match-btn { background: #3d3d3d; border: 1px solid #555; color: white; padding: 12px 10px; border-radius: 8px; cursor: pointer; font-size: 0.85em; min-height: 60px; }
.match-btn.selected { border-color: var(--primary-color); background: rgba(210, 105, 30, 0.2); }
.match-btn.matched { background: #4caf50; border-color: #4caf50; cursor: default; }
	/* 画面フラッシュ演出 */
.flash-white {
    animation: flashFade 0.5s ease-out;
}

@keyframes flashFade {
    0% { background-color: rgba(255, 255, 255, 1); }
    100% { background-color: rgba(26, 26, 26, 0.95); }
}
/* スマホでの組み合わせボタンの調整 */
@media (max-width: 480px) {
    .matching-grid { gap: 8px; }
    .match-btn {
        padding: 8px 4px;
        font-size: 0.8em;
        min-height: 50px;
    }
}

/* 選択中のボタンを強調 */
.match-btn.selected {
    border: 2px solid var(--primary-color) !important;
    background: rgba(210, 105, 30, 0.3) !important;
}
	
</style>
</head>
<body>

<div id="quiz-app">
<div id="countdown-overlay" class="hidden" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); flex-direction:column; justify-content:center; align-items:center; z-index:1000; backdrop-filter:blur(5px); display:none;">
  <div style="background:var(--card-bg); padding:40px; border-radius:30px; border:2px solid var(--primary-color); text-align:center;">
    <div id="countdown-num" style="font-size:6em; font-weight:900; color:var(--primary-color); line-height:1;"></div>
    <div id="countdown-label" style="font-size:1.2em; letter-spacing:5px; margin-top:10px; color:#aaa;">READY...</div>
  </div>
</div>

  <div id="level-select" class="level-menu">
    <h1 style="color:var(--primary-color);margin-bottom:5px;">Amber Palette</h1>
    <h3 style="margin-top:0;opacity:.7;">Whisky Quiz Master</h3>
    <button class="level-btn" onclick="startQuiz('初級')">初級</button>
    <button class="level-btn" onclick="startQuiz('中級')">中級</button>
    <button class="level-btn" onclick="startQuiz('上級')">上級</button>
    <button class="level-btn" onclick="startQuiz('カルト級')">カルト級</button>
    <button class="level-btn" onclick="startQuiz('組み合わせ')">組み合わせ</button>
    <div style="margin-top:20px;"><a href="https://amber-palette-hub.vercel.app/" class="home-btn" style="text-decoration:none;">← HUBへ戻る</a></div>
  </div>

<div id="quiz-container" class="hidden">
  <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
    <button class="home-btn" onclick="confirmHome()">✕ クイズを中断</button>
    <button id="sound-toggle" class="home-btn" onclick="toggleSound()">🔊 ON</button>
  </div>
  
  <div id="timer-container"><div id="timer-bar"></div></div>
  <div class="progress"><span id="display-level"></span> ｜ QUESTION <span id="current-num"></span></div>
  
  <div id="question-text" class="question"></div>

  <div id="options-container" class="options"></div>

  <div id="matching-container" class="hidden"></div>

  <div id="feedback">
    <div id="result-text" style="font-weight:bold;"></div>
    <div id="rationale-text" style="font-size:.9em;color:#ccc;"></div>
  </div>
  <button id="next-btn" class="next-btn" onclick="handleNext()">次の問題へ進む</button>
</div>

  <div id="result-container" class="hidden" style="text-align:center;">
    <div id="rank-name" class="rank-title" style="font-size:2em; color:var(--primary-color); font-weight:900;"></div>
    <div style="font-size:1.2em;margin:20px 0;">正解数: <span id="final-score"></span></div>
    <div id="praise-message" class="praise-msg" style="background:#383838; padding:20px; border-radius:10px; margin-bottom:30px;"></div>
    <button class="home-btn" onclick="goHome()">レベル選択へ戻る</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="startQuiz.js" defer></script>

<script>
function confirmHome(){ if(confirm("クイズを中断してレベル選択に戻りますか？")){ goHome(); } }
</script>
</body>
</html>